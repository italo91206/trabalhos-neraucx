<!-- block identifier: category_application_construction_footer_blog -->
<link rel="stylesheet" type="text/css" media="all" href="{{media url=css/blog_styles.css}}">
<div class="blog_posts">
    <div class="lastest_post">
        <h2 class="title">LATEST FROM BLOG</h2>
        <div id="last_container"></div>
    </div>
    <div class="lastest_posts">
        <h2 class="title">RECENT POSTS</h2>
        <div id="recent_container"></div>
    </div>
</div>

<script type="text/javascript" xml="space">
    require([
        'jquery'
    ], function (jQuery) {
        jQuery(document).ready(function ($) {
            jQuery.get('https://blog.soncocrowdcontrol.com/wp-json/wp/v2/posts?categories=11', function (data, status) {
                var posts = data;
                if (posts[0]) {
                    var last = posts[0];
                    jQuery('#last_container').append(`<div class="post">
                        <img src="" id="featured`+ last.id + `" alt="" class="featured" />
                            <div id="title" class="title">`+ last.title.rendered + `</div>
                            <div id="content" class="content">`+ last.excerpt.rendered + `</div>
                            <div class="action">
                            <a href="`+ last.link + `" target="_blank" class="see_more">See more</a>
                            </div>
                        </div>`);
                    jQuery.get(last._links['wp:featuredmedia'][0].href, function (mediaData, status) {
                        jQuery('#featured' + last.id).attr('src', mediaData.source_url);
                    });
                }

                for (var i = 1; i <= 4; i++) {
                    if (posts[i]) {
                        var post = posts[i];
                        loadPost(post);
                    }
                }
            });
            function loadPost(post) {
                jQuery('#recent_container').append(`<div class="post">
                    <img src="" id="featured`+ post.id + `" alt="" class="featured" />
                    <div id="title" class="title">`+ post.title.rendered + `</div>
                    <div id="content" class="content">`+ post.excerpt.rendered + `</div>
                    <div class="action">
                    <a href="`+ post.link + `" target="_blank" class="see_more">See more</a>
                    </div>
                    </div>`);
                jQuery.get(post._links['wp:featuredmedia'][0].href, function (mediaData, status) {
                    jQuery('#featured' + post.id).attr('src', mediaData.source_url);
                });
            }
        });
    });
</script>
<!-- /block identifier: category_construction_footer_blog -->